var $=(_,O,i)=>new Promise((b,g)=>{var u=p=>{try{d(i.next(p))}catch(k){g(k)}},w=p=>{try{d(i.throw(p))}catch(k){g(k)}},d=p=>p.done?b(p.value):Promise.resolve(p.value).then(u,w);d((i=i.apply(_,O)).next())});import{g as L,o,c as a,a as e,d as v,F as j,h as S,n as h,p as D,t as x,b as F,i as R,w as P,r as y,u as z,k as B,l as V,m as E,x as I,s as M}from"./index-BbVMXxNJ.js";import{T as q,C as A}from"./ConfirmDialog-BX-srcnT.js";const J={class:"h-full flex flex-col bg-white border-r border-gray-200 text-gray-700 font-sans transition-all duration-300"},G={class:"h-14 flex items-center bg-gray-900 text-white shrink-0 px-3 justify-between"},H={key:0,class:"font-bold text-base tracking-wide"},K={class:"flex-1 overflow-y-auto custom-scrollbar text-[13px]"},Q={key:0,class:"p-6 text-center text-gray-400 text-sm"},U={key:1,class:"p-6 text-center text-gray-400"},W=["onClick"],X={class:"flex items-center gap-3"},Y={key:0,class:"text-sm flex items-center gap-2"},Z={key:0,class:"text-[9px] bg-yellow-100 text-yellow-700 px-1.5 py-0.5 rounded border border-yellow-200 font-bold uppercase"},ee={class:"bg-gray-50/50 pb-1"},te=["onClick"],se={class:"flex items-center gap-2 truncate"},oe={class:"truncate"},ae=["onClick"],ne={class:"flex items-center gap-2"},le=["onClick"],re={class:"flex items-center gap-2 truncate"},ie={class:"truncate"},de={__name:"SellerSidebar",props:["isCollapsed"],emits:["close-mobile","filter-orders","reset-filter"],setup(_,{emit:O}){const i=O,b=y([]),g=y(!1),u=y([]),w=y([]),d=y([]),p=y(null),k=()=>$(this,null,function*(){g.value=!0;try{const l=yield(yield fetch("/api/method/doppio_demo.api.get_seller_sidebar_data")).json();if(l.message&&l.message.status==="success"){b.value=l.message.data;const r=b.value.find(c=>c.is_primary);r?u.value.push(r.pincode):b.value.length>0&&u.value.push(b.value[0].pincode)}}catch(f){console.error(f)}finally{g.value=!1}});L(()=>k());const C=(f,l)=>{const r=f==="pincode"?u:f==="society"?w:d,c=r.value.indexOf(l);c>-1?r.value.splice(c,1):r.value.push(l)},T=f=>{p.value=f.name,i("filter-orders",f.name),i("close-mobile")},N=()=>{p.value=null,i("reset-filter")};return(f,l)=>(o(),a("div",J,[e("div",G,[e("div",{class:"flex items-center gap-2 cursor-pointer w-full",onClick:N},[l[1]||(l[1]=e("span",{class:"text-xl"},"ðŸª",-1)),_.isCollapsed?v("",!0):(o(),a("span",H,"Orders"))]),e("button",{onClick:l[0]||(l[0]=r=>f.$emit("close-mobile")),class:"lg:hidden text-gray-400 hover:text-white"},"âœ•")]),e("div",K,[g.value?(o(),a("div",Q,"Loading...")):b.value.length?(o(!0),a(j,{key:2},S(b.value,r=>(o(),a("div",{key:r.pincode,class:"border-b border-gray-50"},[e("button",{onClick:c=>C("pincode",r.pincode),class:h(["w-full flex items-center py-3 hover:bg-gray-50 transition-colors group relative",[_.isCollapsed?"justify-center px-0":"justify-between px-3",u.value.includes(r.pincode)?"bg-gray-100 font-bold text-gray-900":"text-gray-600"]])},[e("div",X,[l[2]||(l[2]=e("span",{class:"text-base text-orange-500"},"ðŸ“",-1)),_.isCollapsed?v("",!0):(o(),a("span",Y,[D(x(r.pincode)+" ",1),r.is_primary?(o(),a("span",Z,"Primary")):v("",!0)]))]),_.isCollapsed?v("",!0):(o(),a("span",{key:0,class:h(["text-[10px] text-gray-400 transition-transform",u.value.includes(r.pincode)?"rotate-180":""])},"â–¼",2))],10,W),F(e("div",ee,[(o(!0),a(j,null,S(r.societies,c=>(o(),a("div",{key:c.name},[e("button",{onClick:P(n=>C("society",c.name),["stop"]),class:h(["w-full flex justify-between pl-8 pr-3 py-2.5 transition-all border-l-[3px]",w.value.includes(c.name)?"border-blue-600 text-blue-700 bg-blue-50 font-bold":"border-transparent text-gray-600 hover:bg-white"])},[e("div",se,[l[3]||(l[3]=e("span",{class:"text-sm opacity-70"},"ðŸ¢",-1)),e("span",oe,x(c.name),1)]),e("span",{class:h(["text-[9px] text-gray-400",w.value.includes(c.name)?"rotate-180":""])},"â–¼",2)],10,te),F(e("div",null,[(o(!0),a(j,null,S(c.categories,n=>(o(),a("div",{key:n.name},[e("button",{onClick:P(t=>C("category",n.name),["stop"]),class:h(["w-full flex justify-between items-center pl-12 pr-3 py-2 text-[11px] uppercase tracking-wider mt-0.5 border-l-[3px] transition-colors",d.value.includes(n.name)?"border-orange-500 text-orange-700 bg-orange-50 font-bold":"border-transparent text-gray-500 hover:text-gray-800 hover:bg-white"])},[e("div",ne,[l[4]||(l[4]=e("span",null,"ðŸ“‚",-1)),e("span",null,x(n.name),1)]),e("span",{class:h(["text-[8px] opacity-50",d.value.includes(n.name)?"rotate-180":""])},"â–¼",2)],10,ae),F(e("div",null,[(o(!0),a(j,null,S(n.customers,t=>(o(),a("div",{key:t.name},[e("button",{onClick:P(s=>T(t),["stop"]),class:h(["w-full text-left pl-[4rem] pr-3 py-2 text-[12px] flex justify-between items-center group transition-all",p.value===t.name?"bg-yellow-50 text-gray-900 font-bold border-r-4 border-yellow-400 shadow-inner":"text-gray-500 hover:bg-white hover:text-gray-900"])},[e("div",re,[l[5]||(l[5]=e("span",null,"ðŸ‘¤",-1)),e("span",ie,x(t.name),1)])],10,le)]))),128))],512),[[R,d.value.includes(n.name)]])]))),128))],512),[[R,w.value.includes(c.name)]])]))),128))],512),[[R,u.value.includes(r.pincode)&&!_.isCollapsed]])]))),128)):(o(),a("div",U,"No active orders."))]),l[6]||(l[6]=e("div",{class:"p-3 border-t border-gray-200 bg-gray-50 text-center text-[10px] text-gray-500 font-bold uppercase tracking-wider"},"Seller Panel",-1))]))}},ce={class:"flex h-screen bg-gray-50 font-sans text-gray-900"},ue={class:"flex-1 flex flex-col h-full overflow-hidden relative w-full"},pe={class:"bg-white h-16 border-b border-gray-200 flex items-center justify-between px-6 shadow-sm z-10"},xe={class:"flex items-center gap-3"},ge={class:"text-xl font-bold text-gray-800"},be={class:"flex-1 overflow-y-auto p-4 sm:p-8 custom-scrollbar bg-gray-50/50"},fe={key:0,class:"mb-4 flex justify-between items-center bg-orange-50 border border-orange-200 p-3 rounded-lg"},me={class:"text-orange-800 text-sm font-bold flex gap-2"},ve={class:"uppercase"},ye={class:"space-y-4"},he={key:0,class:"text-center py-10"},_e={key:1,class:"text-center py-20 bg-white rounded-2xl border border-dashed border-gray-300"},we={class:"bg-gray-50 px-6 py-3 border-b border-gray-100 flex justify-between items-center"},ke={class:"font-mono font-bold text-gray-900"},Ce={class:"text-xs text-gray-500 ml-2"},$e={class:"flex items-center gap-3"},je={class:"font-bold text-gray-800"},Se={class:"p-6"},Oe={class:"w-12 h-12 border rounded bg-white p-1 flex-shrink-0 flex items-center justify-center overflow-hidden"},De=["src"],Ne={key:1,class:"text-xl opacity-20"},Te={class:"flex-1"},Fe={class:"text-sm font-bold text-gray-800"},Re={class:"text-xs text-gray-500"},Pe={class:"text-sm font-bold text-gray-900"},Ve={class:"mt-6 flex justify-end gap-3 pt-4 border-t border-gray-100"},Ie=["onClick"],Le=["onClick"],ze=["onClick"],Be={key:3,class:"text-green-600 font-bold text-sm self-center flex items-center gap-1"},Ae={__name:"SellerView",setup(_){const O=z(),i=y(null),b=y(null),g=y(!1),u=y(null),w=I(()=>u.value?"Filtered Orders":"Dashboard"),d=B({url:"doppio_demo.api.get_seller_orders",auto:!0}),p=I(()=>d.data||[]),k=n=>{u.value=n,d.submit({customer_name:n})},C=()=>{u.value=null,d.submit({customer_name:null})},T=()=>$(this,null,function*(){yield M.logout.submit(),O.push({name:"Home",query:{login:"true"}})}),N=n=>n.per_delivered>=100&&n.per_billed>=100||n.status==="Completed",f=n=>n.docstatus===0?"bg-yellow-100 text-yellow-800":N(n)?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800",l=n=>$(this,null,function*(){try{const s=yield(yield fetch("/api/method/doppio_demo.api.update_order_status",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({order_name:n,status:"To Deliver and Bill"})})).json();if(s.message.status==="success")i.value.add("Order Accepted!","success"),d.fetch();else throw new Error(s.message.message)}catch(t){i.value.add(t.message,"error")}}),r=n=>$(this,null,function*(){if(yield b.value.open("Create Delivery?","Generate Delivery Note?"))try{const s=yield(yield fetch("/api/method/doppio_demo.api.create_delivery_note",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({order_name:n})})).json();if(s.message.status==="success")i.value.add("Delivery Note Created!","success"),d.fetch();else throw new Error(s.message.message)}catch(t){i.value.add(t.message,"error")}}),c=n=>$(this,null,function*(){if(yield b.value.open("Create Invoice?","Generate Sales Invoice?"))try{const s=yield(yield fetch("/api/method/doppio_demo.api.create_sales_invoice",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({order_name:n})})).json();if(s.message.status==="success")i.value.add("Invoice Created!","success"),d.fetch();else throw new Error(s.message.message)}catch(t){i.value.add(t.message,"error")}});return(n,t)=>(o(),a("div",ce,[V(q,{ref_key:"toastRef",ref:i},null,512),V(A,{ref_key:"confirmRef",ref:b},null,512),g.value?(o(),a("div",{key:0,onClick:t[0]||(t[0]=s=>g.value=!1),class:"fixed inset-0 bg-black/60 z-40 lg:hidden backdrop-blur-sm transition-opacity"})):v("",!0),e("div",{class:h(["fixed lg:static inset-y-0 left-0 z-20 shadow-xl transform transition-all duration-300 ease-in-out h-full w-72 shrink-0 bg-white",g.value?"translate-x-0":"-translate-x-full lg:translate-x-0"])},[V(de,{isCollapsed:!1,onCloseMobile:t[1]||(t[1]=s=>g.value=!1),onFilterOrders:k,onResetFilter:C})],2),e("div",ue,[e("header",pe,[e("div",xe,[e("button",{onClick:t[2]||(t[2]=s=>g.value=!g.value),class:"lg:hidden text-gray-600 text-xl"},"â˜°"),e("h1",ge,x(w.value),1)]),e("button",{onClick:T,class:"px-3 py-1.5 rounded text-xs font-bold text-red-600 bg-red-50 hover:bg-red-600 hover:text-white border border-red-100 transition-all"},"Logout")]),e("div",be,[u.value?(o(),a("div",fe,[e("span",me,[t[3]||(t[3]=e("span",null,"ðŸ‘¤",-1)),t[4]||(t[4]=D(" Showing orders for: ",-1)),e("span",ve,x(u.value),1)]),e("button",{onClick:C,class:"text-xs font-bold text-orange-600 hover:underline"},"Clear")])):v("",!0),e("div",ye,[E(d).loading?(o(),a("div",he,[...t[5]||(t[5]=[e("p",{class:"text-gray-400 text-xs font-bold uppercase"},"Syncing...",-1)])])):p.value.length?(o(!0),a(j,{key:2},S(p.value,s=>(o(),a("div",{key:s.name,class:"bg-white rounded-xl border border-gray-200 overflow-hidden shadow-sm hover:shadow-md transition-all"},[e("div",we,[e("div",null,[e("span",ke,"#"+x(s.name),1),e("span",Ce,x(s.customer_name),1)]),e("div",$e,[e("span",{class:h(["px-2 py-1 rounded text-[10px] font-bold uppercase border shadow-sm",f(s)])},x(s.docstatus===0?"Pending Acceptance":s.status),3),e("span",je,"â‚¹"+x(s.grand_total),1)])]),e("div",Se,[(o(!0),a(j,null,S(s.items,m=>(o(),a("div",{key:m.item_code,class:"flex gap-4 items-center py-3 border-b border-gray-100 last:border-0"},[e("div",Oe,[m.image?(o(),a("img",{key:0,src:m.image,class:"w-full h-full object-contain"},null,8,De)):(o(),a("div",Ne,"ðŸ“¦"))]),e("div",Te,[e("p",Fe,x(m.item_name),1),e("p",Re,x(m.qty)+" x â‚¹"+x(m.amount/m.qty),1)]),e("span",Pe,"â‚¹"+x(m.amount),1)]))),128)),e("div",Ve,[s.docstatus===0?(o(),a("button",{key:0,onClick:m=>l(s.name),class:"bg-blue-600 hover:bg-blue-700 text-white px-5 py-2 rounded-lg text-xs font-bold uppercase shadow-md transition-all flex items-center gap-2"},[...t[7]||(t[7]=[e("span",null,"âš¡",-1),D(" Accept Order ",-1)])],8,Ie)):v("",!0),s.docstatus===1&&(s.per_delivered||0)<100?(o(),a("button",{key:1,onClick:m=>r(s.name),class:"bg-orange-500 hover:bg-orange-600 text-white px-5 py-2 rounded-lg text-xs font-bold uppercase shadow-md transition-all flex items-center gap-2"},[...t[8]||(t[8]=[e("span",null,"ðŸšš",-1),D(" Deliver ",-1)])],8,Le)):v("",!0),s.docstatus===1&&(s.per_billed||0)<100?(o(),a("button",{key:2,onClick:m=>c(s.name),class:"bg-green-600 hover:bg-green-700 text-white px-5 py-2 rounded-lg text-xs font-bold uppercase shadow-md transition-all flex items-center gap-2"},[...t[9]||(t[9]=[e("span",null,"ðŸ§¾",-1),D(" Invoice ",-1)])],8,ze)):v("",!0),N(s)?(o(),a("span",Be,"âœ… Completed")):v("",!0)])])]))),128)):(o(),a("div",_e,[...t[6]||(t[6]=[e("p",{class:"text-gray-400 font-bold"},"No orders found.",-1)])]))])])])]))}};export{Ae as default};
//# sourceMappingURL=SellerView-B5UTHHoJ.js.map
